# Phase B å®æ–½è®¡åˆ’ï¼šDebug Console æ ¸å¿ƒæ”¹é€ 

> æ—¥æœŸ: 2026-02-21
> çŠ¶æ€: è®¡åˆ’å®Œæˆï¼Œå¾…å®æ–½
> å‰ç½®æ¡ä»¶: Phase A + Phase C å·²å®Œæˆ (733fedf)

---

## ä¸€ã€ç›®æ ‡æ¦‚è¿°

å°† ChatPage æ”¹é€ ä¸º **IDE é£æ ¼å››é¢æ¿å¸ƒå±€**çš„ Debug Consoleï¼Œæä¾›é›†ä¸­åŒ–çš„ Agent å¼€å‘è°ƒè¯•ä½“éªŒã€‚

---

## äºŒã€æ•´ä½“å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NanoGridBot    [workspace-name â–¼]   [metrics]   [âš™ï¸] [ğŸ‘¤]         â”‚  â† Top Bar (å·²æœ‰)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        â”‚                                        â”‚                    â”‚
â”‚  W     â”‚    Conversation Stream (ä¸»åŒºåŸŸ)       â”‚   Inspector       â”‚
â”‚  o     â”‚                                        â”‚   (å³ä¾§é¢æ¿)       â”‚
â”‚  r     â”‚  â”Œ thinking... â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                    â”‚
â”‚  k     â”‚  â”‚ (collapsible)                â”‚    â”‚  â”Œ Tool Call â”€â”€â”€â” â”‚
â”‚  s     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚ tool: Bash   â”‚ â”‚
â”‚  p     â”‚  [user message]                     â”‚  â”‚ input: {...} â”‚ â”‚
â”‚  a     â”‚  [tool: Edit app.py]                â”‚  â”‚ output: ...  â”‚ â”‚
â”‚  c     â”‚  [code diff inline]                 â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  e     â”‚  [agent response]                   â”‚                    â”‚
â”‚  s     â”‚                                        â”‚  â”Œ Session â”€â”€â”€â”€â”€â” â”‚
â”‚        â”‚                                        â”‚  â”‚ Tokens: 12k  â”‚ â”‚
â”‚  â”€â”€â”€â”€  â”‚  [input area                   â]   â”‚  â”‚ Duration: 45sâ”‚ â”‚
â”‚ + New  â”‚                                        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Container Output  â”‚  IPC Stream  â”‚  Metrics                      â”‚
â”‚  $ claude --prompt "..."                                          â”‚
â”‚  [real-time stdout/stderr stream]                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†‘ åº•éƒ¨é¢æ¿ (å¯æŠ˜å ï¼Œ3 ä¸ª Tab)
```

---

## ä¸‰ã€é¢æ¿èŒè´£

### 3.1 å·¦ä¾§ Workspace åˆ—è¡¨ (~200pxï¼Œå¯æŠ˜å )

| åŠŸèƒ½ | å®ç° |
|------|------|
| å½“å‰ç”¨æˆ·çš„ Workspace åˆ—è¡¨ | GET `/api/user/groups` |
| æ˜¾ç¤ºï¼šåç§°ã€çŠ¶æ€æŒ‡ç¤ºç¯ã€æœªè¯»æ•° | ä½¿ç”¨ `groups[].status` |
| åº•éƒ¨ã€Œ+ Newã€æŒ‰é’® | å¤ç”¨ç°æœ‰ CreateContainerDialog |
| ç‚¹å‡»åˆ‡æ¢ï¼ŒåŠ è½½æ¶ˆæ¯æµ | å¤ç”¨ç°æœ‰æ¶ˆæ¯åŠ è½½é€»è¾‘ |

**ç»„ä»¶**: æ–°å»º `WorkspaceList.tsx`

### 3.2 ä¸­é—´ Conversation Streamï¼ˆä¸»åŒºåŸŸï¼‰

æ¶ˆæ¯ç±»å‹åŒºåˆ†æ¸²æŸ“ï¼š

| æ¶ˆæ¯ç±»å‹ | æ¸²æŸ“æ–¹å¼ |
|---------|---------|
| User Message | ç®€æ´æ°”æ³¡ï¼ˆå·²æœ‰ï¼‰ |
| Thinking | æŠ˜å å—ï¼Œç‚¹å‡»å±•å¼€ï¼ˆéœ€æ”¹é€  MessageBubbleï¼‰ |
| Tool Call | ç´§å‡‘å¡ç‰‡ï¼Œç‚¹å‡»åœ¨ Inspector å±•å¼€ï¼ˆéœ€æ–°å¢ï¼‰ |
| Agent Response | Markdown æ¸²æŸ“ï¼ˆå·²æœ‰ï¼‰ |
| Code Diff | å†…åµŒ diff æŸ¥çœ‹å™¨ï¼ˆéœ€æ–°å¢ DiffViewerï¼‰ |
| Error | çº¢è‰²è¾¹æ¡†å¡ç‰‡ï¼ˆéœ€æ”¹é€ ï¼‰ |

**æ”¹é€ æ–‡ä»¶**:
- `MessageBubble.tsx` - æ”¯æŒ Thinking æŠ˜å 
- æ–°å»º `DiffViewer.tsx` - ä»£ç  diff æ¸²æŸ“
- æ–°å»º `ToolCallCard.tsx` - å·¥å…·è°ƒç”¨å¡ç‰‡

### 3.3 å³ä¾§ Inspectorï¼ˆ~300pxï¼Œå¯æŠ˜å ï¼‰

| åŠŸèƒ½ | å®ç° |
|------|------|
| Tool Call è¯¦æƒ… | å®Œæ•´è¾“å…¥å‚æ•° + è¾“å‡ºç»“æœï¼Œå¯å¤åˆ¶ |
| Thinking è¯¦æƒ… | å®Œæ•´æ¨ç†æ–‡æœ¬ |
| Session å…ƒæ•°æ® | session_idã€tokenã€æ—¶é•¿ã€å®¹å™¨ ID |
| æ–‡ä»¶å˜æ›´æ±‡æ€» | å½“å‰ä¼šè¯æ‰€æœ‰ Read/Edit/Write æ–‡ä»¶ |
| æœªé€‰ä¸­æ—¶ | æ˜¾ç¤º Workspace æ¦‚è§ˆ |

**ç»„ä»¶**: æ–°å»º `InspectorPanel.tsx`

### 3.4 åº•éƒ¨é¢æ¿ï¼ˆå¯æŠ˜å ï¼Œé»˜è®¤ ~150pxï¼Œ3 ä¸ª Tabï¼‰

| Tab | å†…å®¹ | å¤ç”¨ |
|-----|------|------|
| Container Output | å®¹å™¨ stdout/stderr å®æ—¶æµ | å·²æœ‰ TerminalPanel |
| IPC Stream | IPC åŸå§‹ JSON æµï¼ˆå¼€å‘è°ƒè¯•ï¼‰ | æ–°å»º |
| Metrics | å®¹å™¨æ‰§è¡Œç»Ÿè®¡ | å·²æœ‰ `/api/metrics` |

**æ”¹é€ **: å°† TerminalPanel ä»å³ä¾§ç§»åˆ°åº•éƒ¨

---

## å››ã€å®æ–½ä»»åŠ¡

### Task 1: å¸ƒå±€éª¨æ¶æ­å»º

| å­ä»»åŠ¡ | æ–‡ä»¶ | è¯´æ˜ |
|--------|------|------|
| 1.1 | `ChatPage.tsx` | é‡æ„ä¸ºå››é¢æ¿å¸ƒå±€æ¡†æ¶ |
| 1.2 | æ–°å»º `WorkspaceList.tsx` | å·¦ä¾§ Workspace åˆ—è¡¨ |
| 1.3 | æ–°å»º `InspectorPanel.tsx` | å³ä¾§ Inspector é¢æ¿ |
| 1.4 | æ–°å»º `BottomPanel.tsx` | åº•éƒ¨é¢æ¿ï¼ˆ3 Tabï¼‰ |

### Task 2: å¯¹è¯æµå¢å¼º

| å­ä»»åŠ¡ | æ–‡ä»¶ | è¯´æ˜ |
|--------|------|------|
| 2.1 | `MessageBubble.tsx` | Thinking æŠ˜å å— |
| 2.2 | æ–°å»º `DiffViewer.tsx` | ä»£ç  diff æ¸²æŸ“ |
| 2.3 | æ–°å»º `ToolCallCard.tsx` | å·¥å…·è°ƒç”¨ç´§å‡‘å¡ç‰‡ |
| 2.4 | `MessageList.tsx` | æ”¯æŒæ¶ˆæ¯ç‚¹å‡»äº‹ä»¶ |

### Task 3: Inspector é¢æ¿

| å­ä»»åŠ¡ | æ–‡ä»¶ | è¯´æ˜ |
|--------|------|------|
| 3.1 | `InspectorPanel.tsx` | å·¥å…·è°ƒç”¨è¯¦æƒ…å±•ç¤º |
| 3.2 | `InspectorPanel.tsx` | Thinking è¯¦æƒ…å±•ç¤º |
| 3.3 | `InspectorPanel.tsx` | Session å…ƒæ•°æ®å±•ç¤º |
| 3.4 | `InspectorPanel.tsx` | æ–‡ä»¶å˜æ›´æ±‡æ€» |

### Task 4: åº•éƒ¨é¢æ¿

| å­ä»»åŠ¡ | æ–‡ä»¶ | è¯´æ˜ |
|--------|------|------|
| 4.1 | `BottomPanel.tsx` | Tab åˆ‡æ¢é€»è¾‘ |
| 4.2 | ç§»åŠ¨ `TerminalPanel.tsx` | ä»ä¾§è¾¹ç§»åˆ°åº•éƒ¨ |
| 4.3 | æ–°å»º `IPCPanel.tsx` | IPC åŸå§‹ JSON æµ |
| 4.4 | æ–°å»º `MetricsPanel.tsx` | å®¹å™¨æ‰§è¡Œç»Ÿè®¡ |

### Task 5: çŠ¶æ€ç®¡ç†

| å­ä»»åŠ¡ | æ–‡ä»¶ | è¯´æ˜ |
|--------|------|------|
| 5.1 | `chat.ts` store | æ·»åŠ  selectedMessage çŠ¶æ€ |
| 5.2 | `chat.ts` store | æ·»åŠ  bottomPanelTab çŠ¶æ€ |
| 5.3 | `chat.ts` store | æ·»åŠ  inspectorOpen çŠ¶æ€ |

### Task 6: å“åº”å¼é€‚é…

| å­ä»»åŠ¡ | è¯´æ˜ |
|--------|------|
| 6.1 | æ¡Œé¢ç«¯ï¼šå››é¢æ¿å®Œæ•´å±•ç¤º |
| 6.2 | å¹³æ¿ç«¯ï¼šInspector æŠ½å±‰åŒ– |
| 6.3 | ç§»åŠ¨ç«¯ï¼šå•é¢æ¿ + åº•éƒ¨å¯¼èˆª |

---

## äº”ã€æ–‡ä»¶å˜æ›´æ¸…å•

### æ–°å»ºæ–‡ä»¶

| æ–‡ä»¶ | ç”¨é€” |
|------|------|
| `frontend/src/components/console/WorkspaceList.tsx` | å·¦ä¾§ Workspace åˆ—è¡¨ |
| `frontend/src/components/console/InspectorPanel.tsx` | å³ä¾§ Inspector é¢æ¿ |
| `frontend/src/components/console/BottomPanel.tsx` | åº•éƒ¨é¢æ¿ |
| `frontend/src/components/console/IPCPanel.tsx` | IPC åŸå§‹ JSON æµ |
| `frontend/src/components/console/MetricsPanel.tsx` | å®¹å™¨ç»Ÿè®¡ |
| `frontend/src/components/chat/DiffViewer.tsx` | ä»£ç  diff æ¸²æŸ“ |
| `frontend/src/components/chat/ToolCallCard.tsx` | å·¥å…·è°ƒç”¨å¡ç‰‡ |

### ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | å˜æ›´ |
|------|------|
| `frontend/src/pages/ChatPage.tsx` | é‡æ„ä¸ºå››é¢æ¿å¸ƒå±€ |
| `frontend/src/components/chat/ChatView.tsx` | æ‹†åˆ†/ç§»é™¤éƒ¨åˆ†åŠŸèƒ½ |
| `frontend/src/components/chat/MessageBubble.tsx` | æ·»åŠ  Thinking æŠ˜å  |
| `frontend/src/components/chat/MessageList.tsx` | æ·»åŠ æ¶ˆæ¯ç‚¹å‡»äº‹ä»¶ |
| `frontend/src/stores/chat.ts` | æ·»åŠ æ–°çŠ¶æ€å­—æ®µ |
| `frontend/src/components/chat/TerminalPanel.tsx` | ç§»åŠ¨åˆ°åº•éƒ¨é¢æ¿ |

---

## å…­ã€ä¾èµ–

| ä¾èµ– | ç”¨é€” | çŠ¶æ€ |
|------|------|------|
| `@xterm/xterm` | ç»ˆç«¯æ¸²æŸ“ | å·²æœ‰ |
| `react-markdown` | Markdown æ¸²æŸ“ | å·²æœ‰ |
| `diff` | diff ç®—æ³• | éœ€å®‰è£… |
| `@tanstack/react-virtual` | è™šæ‹Ÿåˆ—è¡¨ï¼ˆå¤§é‡æ¶ˆæ¯ï¼‰ | å·²æœ‰ zustand |

---

## ä¸ƒã€API éœ€æ±‚

| API | ç”¨é€” | çŠ¶æ€ |
|-----|------|------|
| `GET /api/user/groups` | è·å–ç”¨æˆ· Workspace åˆ—è¡¨ | å·²æœ‰ |
| `GET /api/groups/{jid}/messages` | è·å–æ¶ˆæ¯å†å² | å·²æœ‰ |
| `GET /api/metrics/containers` | å®¹å™¨æ‰§è¡Œç»Ÿè®¡ | å·²æœ‰ |
| `WebSocket /ws` | å®æ—¶æ¶ˆæ¯æµ | å·²æœ‰ |

**æ–°å¢éœ€æ±‚**:
- `GET /api/groups/{jid}/files` - å½“å‰ä¼šè¯æ–‡ä»¶å˜æ›´åˆ—è¡¨ï¼ˆå¯èƒ½éœ€è¦æ–°å¢ï¼‰

---

## å…«ã€æµ‹è¯•è®¡åˆ’

| æµ‹è¯•ç±»å‹ | è¦†ç›– |
|---------|------|
| å•å…ƒæµ‹è¯• | WorkspaceList, InspectorPanel, BottomPanel |
| é›†æˆæµ‹è¯• | å››é¢æ¿å¸ƒå±€æ¸²æŸ“ |
| E2E | å®Œæ•´å¯¹è¯æµç¨‹ |

---

## ä¹ã€é‡Œç¨‹ç¢‘

| é‡Œç¨‹ç¢‘ | ä»»åŠ¡ |
|--------|------|
| M1 | Task 1: å¸ƒå±€éª¨æ¶æ­å»º |
| M2 | Task 2: å¯¹è¯æµå¢å¼º |
| M3 | Task 3-4: Inspector + åº•éƒ¨é¢æ¿ |
| M4 | Task 5-6: çŠ¶æ€ç®¡ç† + å“åº”å¼ |
| M5 | æµ‹è¯• + Bug ä¿®å¤ |

---

## åã€åç»­å·¥ä½œ

- Phase D: User/Workspace å…³ç³»æ¨¡å‹è°ƒæ•´
- Phase D: IM é€šé“ç®¡ç†é‡æ–°è®¾è®¡
- Phase D: Skills/Tasks/Memory æœ€ç»ˆä½ç½®

---

## åä¸€ã€å‚è€ƒæ–‡æ¡£

- è®¾è®¡æ–‡æ¡£: `docs/plans/2026-02-21-frontend-redesign.md`
- Phase A+C å®æ–½: `docs/plans/2026-02-21-frontend-phase-ac-impl.md`
